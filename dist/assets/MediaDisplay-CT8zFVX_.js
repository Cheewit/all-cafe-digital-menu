import{r as a,j as t}from"./index-BPHvCye1.js";const C=s=>{var d,l,c,o,i;let e=null;try{const r=new URL(s);if((r.hostname==="www.youtube.com"||r.hostname==="youtube.com")&&(r.pathname==="/watch"&&(e=r.searchParams.get("v"),e)||r.pathname.startsWith("/shorts/")&&(e=(l=(d=r.pathname.split("/shorts/")[1])==null?void 0:d.split("?")[0])==null?void 0:l.split("&")[0],e)||r.pathname.startsWith("/embed/")&&(e=(o=(c=r.pathname.split("/embed/")[1])==null?void 0:c.split("?")[0])==null?void 0:o.split("&")[0],e))||r.hostname==="youtu.be"&&(e=(i=r.pathname.substring(1).split("?")[0])==null?void 0:i.split("&")[0],e))return e}catch{return null}return e},j=["Our painter is missing, but we promise it's good! ðŸŽ¨","So delicious it disappeared! ðŸ‘»","Invisible ink was used here ðŸ–Šï¸","Image on coffee break â˜•","Too hot to handle for the camera ðŸ”¥","Imagine the perfect drink here âœ¨","404: Drink found, Image lost ðŸ”","Trust us, it looks amazing ðŸ¤©","Camera ate the drink ðŸ“¸"],$=({url:s,altText:e,type:d,priority:l=!1})=>{var v;const[c,o]=a.useState(!1),[i,r]=a.useState(!1),[m,g]=a.useState(s),[f,x]=a.useState(0),N=4,n=a.useRef(null),u=a.useRef(null),k=a.useMemo(()=>{const b=Math.floor(Math.random()*j.length);return j[b]},[]);a.useEffect(()=>{r(!1),o(!1),x(0),g(s),n.current&&(clearTimeout(n.current),n.current=null)},[s]),a.useEffect(()=>{u.current&&u.current.complete&&u.current.naturalWidth>0&&r(!0)},[m]),a.useEffect(()=>()=>{n.current&&clearTimeout(n.current)},[]);const w=a.useCallback(()=>{if(f<N){const b=Math.pow(2,f)*1e3;n.current=setTimeout(()=>{const S=s.includes("?")?"&":"?",E=Math.random().toString(36).substring(7),M=`${s}${S}retry=${Date.now()}_${E}`;g(M),x(R=>R+1)},b)}else o(!0)},[f,s]),I=()=>{r(!0)};if(c)return t.jsxs("div",{className:"w-full h-full flex items-center justify-center bg-stone-200 text-stone-500 p-4 text-center relative overflow-hidden group",children:[t.jsx("div",{className:"glass-panel bg-white/40 backdrop-blur-sm p-3 rounded-xl border border-white/20 shadow-sm max-w-[90%]",children:t.jsx("p",{className:"text-xs md:text-sm font-semibold heading-font leading-tight opacity-80",children:k})}),t.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none",style:{backgroundImage:"radial-gradient(circle, currentColor 1px, transparent 1px)",backgroundSize:"10px 10px"}})]});if(!s)return t.jsx("div",{className:"w-full h-full flex items-center justify-center bg-stone-200 text-[#924d26]",children:t.jsxs("div",{className:"text-center opacity-60",children:[t.jsx("span",{className:"text-4xl block mb-2",children:"â˜•"}),t.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"BaristA:i"})]})});const p=C(s);if(p)return t.jsxs("div",{className:"relative w-full h-full",children:[t.jsx("iframe",{className:"w-full h-full",src:`https://www.youtube.com/embed/${p}?autoplay=1&mute=1&loop=1&playlist=${p}&controls=0&showinfo=0&rel=0&iv_load_policy=3&modestbranding=1`,title:e||"Product video",frameBorder:"0",allow:"autoplay; encrypted-media;",allowFullScreen:!1}),t.jsx("div",{className:"absolute inset-0 bg-transparent hover:bg-black/5 hover:ring-1 hover:ring-inset hover:ring-white/20 z-10 cursor-pointer transition-all duration-200"})]});const h=(v=s.split(".").pop())==null?void 0:v.toLowerCase(),y=h==null?void 0:h.split("?")[0];return y==="mp4"||y==="webm"?t.jsx("video",{src:m,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover",onError:w}):t.jsxs("div",{className:"w-full h-full bg-stone-200 relative overflow-hidden",children:[t.jsx("img",{ref:u,src:m,alt:e,loading:l?"eager":"lazy",onLoad:I,onError:w,className:`w-full h-full object-cover absolute inset-0 transition-opacity duration-500 ${i?"opacity-100":"opacity-0"}`}),!i&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-stone-100",children:t.jsx("div",{className:"w-6 h-6 border-2 border-[var(--bdl-brand)] border-t-transparent rounded-full animate-spin opacity-50"})})]})};export{$ as M};
